--- /sys/src/9/port/proc.c	Wed Oct 31 21:39:42 2018
+++ ../frontmods/port/proc.c	Wed Oct 31 22:08:50 2018
@@ -619,6 +619,7 @@
 	p->egrp = nil;
 	p->fgrp = nil;
 	p->rgrp = nil;
+	p->sgrp = nil;
 	p->pdbg = nil;
 	p->fpstate = FPinit;
 	p->kp = 0;
@@ -1088,6 +1089,7 @@
 	Egrp *egrp;
 	Rgrp *rgrp;
 	Pgrp *pgrp;
+	Sgrp *sgrp;
 	Chan *dot;
 	void (*pt)(Proc*, int, vlong);
 
@@ -1117,6 +1119,13 @@
 		closeegrp(egrp);
 	if(rgrp != nil)
 		closergrp(rgrp);
+	/* sgrp is nilled out here because closefgrp may need srvclose */
+	qlock(&up->debug);
+	sgrp = up->sgrp;
+	up->sgrp = nil;
+	qunlock(&up->debug);
+	if(sgrp != nil)
+		closesgrp(sgrp);
 	if(dot != nil)
 		cclose(dot);
 	if(pgrp != nil)
